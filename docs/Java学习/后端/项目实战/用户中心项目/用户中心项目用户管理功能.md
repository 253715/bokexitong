---
tags:
  - Java项目实战
  - SpringBoot
  - 用户中心项目
readingTime: true
date: 2025-05-08 16:13:38
recommend: ['用户中心项目',5]
---

# 用户中心项目用户管理功能

<font color="#ff0000">！！！必须鉴权​</font>
1. 查询用户​
	- 允许根据用户名查询​
2. 删除用户

![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210116799.png)

```Java
@GetMapping("/search")​
public List<User> searchUsers(String username) {​
   QueryWrapper<User> queryWrapper = new QueryWrapper<>();​
   if (StringUtils.isNotBlank(username)) {​
      queryWrapper.like("username", username);​
   }​
   return userService.list(queryWrapper);​
}
```


![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210151066.png)


```Java
@PostMapping("/delete")​
public boolean deleteUser(@RequestBody long id) {​
   if (id <= 0) {​
      return false;​
   }​
   return userService.removeById(id);​
}
```

问题：**此时代码的接口是开放的，没有校验是否是管理员，任何人均可调用，不安全**​
- 解决：增加一个用户角色的字段，进行身份校验​
- 增加用户角色字段
![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210315254.png)

![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210323040.png)

![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210332040.png)

>使用 MyBatisX 插件重新生成代码，替换原来的 User.java 文件【替换后记得对 isDelete 字段添加 @TableLogic 注解】；mapper.xml 文件中记得引用 mapper 修改文件路径；

修改 UserServiceImpl 文件中用户脱敏的代码

![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210408500.png)

修改 UserController 中的 getRole 为 getUserRole【下面完整代码是修改过的】

![image.png](https://imgsbo.oss-cn-shanghai.aliyuncs.com/undefined20250510210427853.png)

- 将 UserServiceImpl 中的用户登录态键 提到 UserService 里